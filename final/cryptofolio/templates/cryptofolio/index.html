{% extends "cryptofolio/layout.html" %}
{% load static %}

{% block title %}

{% endblock %}

{% block body %}

<div class="row">
    <div class="col-3">
        <div>
            <form>
                <input id="search_value" placeholder = "Coin name" type="text">
                <input id="submit_search" type="submit" value="Search" class="btn btn-sm btn-primary">
            </form>
        </div>


<!-- TRENDING  -->
        <h2>Trending</h2>
        <div id="trending_coins"> </div>

<!-- PORTFOLIO COINS -->
        <h2>portfolio</h2>
        <div class="row">
            <div class="col-3">
                {% for coin in user_portfolio %}
                <div>
                    <button class="portfolio_coin" id="portfolio_overview_button" onClick="coin_info('{{coin.coin_name}}')" >{{ coin.coin_name }}</button>
                </div>
                    
                {%  endfor %}
            </div>

            <div class="col-3">
                <ul>
                    {% for coin in user_holdings_amount %}
                    <li class="portfolio_coin_amount">
                        {{ coin }}
                    </li>
                    {%  endfor %}
                </ul>
            </div>
            
            <div class="col-3">
                <ul class="portfolio_price_list"> </ul>
            </div>

            <div class="col-3">
                <ul class="portfolio_total_value_list"> </ul>
            </div>
        </div>

<!-- PORTFOLIO DATA / CHART -->
        
        <h2>Portfolio Info</h2> 
        <p id="total_portfolio_value">None</p> 
        <h3 id="portfolio_chart_timeframe_header"></h3>
        <div id="portfolio_chart" style="height: 400px;">
        </div>
        <button class="btn btn-sm btn-primary portfolio_chart_timeframe_button" id="portfolio_chart_timeframe_1" onClick="portfolio_history_chart(1)">1 days</button>
        <button class="btn btn-sm btn-primary portfolio_chart_timeframe_button" id="portfolio_chart_timeframe_3" onClick="portfolio_history_chart(3)">3 days</button>
        <button class="btn btn-sm btn-primary portfolio_chart_timeframe_button" id="portfolio_chart_timeframe_7" onClick="portfolio_history_chart(7)">7 days</button>
        <button class="btn btn-sm btn-primary portfolio_chart_timeframe_button" id="portfolio_chart_timeframe_30" onClick="portfolio_history_chart(30)">30 days</button>
        
<!-- NOTE  -->
        <div>
            <h2> Coin Note</h2> 
           <p id="coin_note_field"> None </p>   

            <form action="{% url 'index' %}" method="POST">
                {% csrf_token %}
                <input class="form-control" type="text" name="coin_note" placeholder="Write a note">
                <button class="btn btn-sm btn-primary" value="" id="add_note_button" name="add_note_button">Add Note</button>
                
            </form>
            <form action="{% url 'index' %}" method="POST">
                {% csrf_token %}
                <button class="btn btn-sm btn-primary" value="" id="delete_note_button" name="delete_note_button">Delete Note</button>
            </form>

            
        </div>
<!-- TRADE HISTORY  -->
        <h2>Trade history</h2>
        <div class="row">
            <div class="col-3">
                <ul>
                    {% for trade in trade_history reversed %}
                    <li> {{ trade.coin_name }} </li>
                    {%  endfor %}
                </ul>
            </div>
            <div class="col-3">
                <ul>
                    {% for trade in trade_history reversed %}
                    <li> {{ trade.tradetype }} </li>
                    {%  endfor %}
                </ul>
            </div>
            <div class="col-3">
                <ul>
                    {% for trade in trade_history reversed %}
                    <li> {{ trade.amount }} </li>
                    {%  endfor %}
                </ul>
            </div> 
        </div>
    </div>
    

    <div class="col-9" style="border: 2px solid yellow ;">
        <div class="row">
            <!-- COIN CHART  -->
            <div class="col-7 text-center" style="border: 2px solid rgb(4, 128, 10);">
                <div id="coin_image_div">
                    <img id="coin_image">
                </div>

                <h2 id="coin_page_name">{{coin_page_name}}</h2>
                <h4 id="coin_chart_timeframe_header"></h4>

                <div id="coin_chart">
                    <p>coin chart</p>
                </div>
                <div id="coin_chart_timeframe_buttons"></div>
            </div>
            

            <div class="col-5" style="border: 2px solid hotpink;">
                
                <!-- COIN DATA  -->
                <span style="display: inline-block;">
                    <h2>General info</h2> 
                </span>
                <span style="display: inline-block;">
                    <button id="add_trade" class="btn btn-sm btn-primary">Add trade</button>
                </span>
                    <!-- Delete / Add coin to portfolio  -->
                    <span style="display: inline-block;">
                    <form action="{% url 'index' %}" method="POST">
                        {% csrf_token %}
                        <button class="btn btn-sm btn-primary" value="" id="portfolio_button" name="addportfolio">Add to portfolio</button>
                    </form>
                </span>


                <div class="row">
                    <div class="col-3">
                        <ul id="coin_info_heads">
                            <li>Name:</li>
                            <li>Ticker:</li>
                            <li>Price:</li>
                            <li>Market cap:</li>
                            <li>All-time high:</li>
                            <li>All-time low:</li>
                        </ul>
                    </div>
                    <div class="col-3">
                        <ul>
                            <li id="coin_info_name"></li>
                            <li id="coin_info_ticker"></li>
                            <li id="coin_info_price"></li>
                            <li id="coin_info_marketcap"></li>
                            <li id="coin_info_atl"></li>
                            <li id="coin_info_ath"></li>
                        </ul>
                    </div>
                    <div class="col">
                        <ul>
                            <br> <br> <br> <br>
                            <li id="coin_info_atl_date"></li>
                            <li id="coin_info_ath_date"></li>
                        </ul>
                    </div>
                    <div id="coin_description_box">
                        <h4>Description</h4>
                        <div id="coin_info_description" class="scrollbar scrollbar-primary"> 
                        </div>
                    </div>
                    
                    
                </div>
            </div>
<!-- SOCIALS  -->
            <div class="col-6">
                <h2>Social Media</h2>
                <!-- TWITTER  -->
                <h3>Twitter</h3>
                <div id="twitter_channel"> </div>
            </div>
            <!-- GOOGLE TRENDS  -->
            <div class="col-6" >
                <h2>Google trends</h2>
               
            </div>
        </div>
    </div>
</div>

<!-- SETTINGS FIELD  -->
<div id="settings_field" class="frontfield" style="display: none">
    <h2>Settings</h2>
    <div id="settings_download_data">
        <button class="btn btn-sm btn-primary" onClick="download_trade_data()">Generate trade data CSV</button>
    </div>

    <input class="btn btn-primary close_field" type="submit" value="close">
</div>


<!-- LOGIN FIELD -->
{% if message_login %}
    <div id="login_field" class="frontfield" style="display: block">
        {{ message_login }}
{% else %}
    <div id="login_field" class="frontfield" style="display: none">
{% endif %}
        <form action="{% url 'index' %}" method="POST">
            {% csrf_token %}
            <div class="form-group">
                <input autofocus class="form-control" type="email" name="email" placeholder="Email">
            </div>
            <div class="form-group">
                <input id="login_password_field" class="form-control" type="password" name="password" placeholder="Password">
            </div>
            <input id="login_field_button" class="btn btn-primary" type="submit" value="Login">
        </form>
        <p> Don't have an account? Register <span id="register">here</span>. </p>
        
        <input class="btn btn-primary close_field" type="submit" value="close">
    </div>

<!-- REGISTER FIELD-->
{% if message_register %}
    <div id="register_field" class="frontfield" style="display: block">
        {{ message_register }}
{% else %}
    <div id="register_field" class="frontfield" style="display: none">
{% endif %}
        <form action="{% url 'index' %}" method="POST">
            {% csrf_token %}
            <div class="form-group">
                <input class="form-control" autofocus type="text" name="username" placeholder="Username">
            </div>
            <div class="form-group">
                <input class="form-control" type="email" name="email" placeholder="Email Address">
            </div>
            <div class="form-group">
                <input class="form-control" type="password" name="password" placeholder="Password">
            </div>
            <div class="form-group">
                <input id="register_password_field" class="form-control" type="password" name="confirmation" placeholder="Confirm Password">
            </div>
            <input id="register_field_button" class="btn btn-primary" type="submit" value="Register">
        </form>
        <p> Already have an account? Log In <span class="login">here</span>. </p>
        
        <input class="btn btn-primary close_field" type="submit" value="close">
    </div>

<!-- ADD-TRADE FIELD-->
<div id="addtrade_field" class="frontfield" style="display: none">
    <h2 id="addtrade_header"></h2>
    <form action="{% url 'index' %}" method="POST">
        {% csrf_token %}
        <div class="form-group">
            Name: <input id="addtrade_input_name" autofocus class="form-control" type="text" name="coin_name" placeholder="Coin name" required>
        </div>
        <div class="form-group">
            Amount: <input class="form-control" type="text" name="coin_amount" placeholder="Amount" required>
        </div>
        <div class="form-group">
            Price in $: <input id="addtrade_input_price" class="form-control" type="text" name="coin_price" placeholder="Amount" required>
        </div>
        <div class="form-group">
            SELL
            <label class="switch">
                <input type="checkbox" name="trade_type" checked>
                <span class="slider round"></span>
              </label>
            BUY
        </div>
      
        <input class="btn btn-primary" type="submit" value="Add trade" name="add_trade">
    </form>
    <p> Don't have an account? Register <span id="register">here</span>. </p>
    
    <input class="btn btn-primary close_field" type="submit" value="close">
</div>  





<div style="margin: 5%;"> 
    <h1> 
        <u></u> 
    </h1> 
    <h2> 
        <u></u> 
    </h2> 
    <h4 id='alldata'></h4><br> 
    <h2> 
        <u></u> 
    </h2> 
    <h4 id='neatdata'></h4> 
</div> 


{% endblock %}

{% block script %}
<!-- TWITTER open-->
<!-- <script>window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
      t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
  
    t._e = [];
    t.ready = function(f) {
      t._e.push(f);
    };
    return t;
  }(document, "script", "twitter-wjs"));</script> -->
<!-- TWITTER close-->

<!-- GRAPH OPEN  -->
<!-- <script>
 
</script> -->
<!-- GRAPH CLOSE  -->

<script> 
    var trade_history_data = JSON.parse("{{trade_data_JSON|escapejs}}"); 
    var notes_data = JSON.parse("{{notes_data_JSON|escapejs}}"); 
</script>


    <script src="{% static 'index.js' %}"></script>
{% endblock %}
